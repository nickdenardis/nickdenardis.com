(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{431:function(e,t,a){"use strict";a.r(t);var n=a(4),s=Object(n.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("img",{attrs:{src:"/images/email_graph.gif",alt:""}})]),e._v(" "),t("p",[e._v("Sending email from a web site using PHP’s "),t("a",{attrs:{href:"http://php.net/mail/",target:"_blank",rel:"noopener noreferrer"}},[e._v("mail() function"),t("OutboundLink")],1),e._v(" is a pretty routine task. Contact forms, friend requests, alerts, errors… Servers hosting one or two sites the time to send an email is not even noticeable, but on a server that hosts 200+ sites the time creeps up the two to three second range.")]),e._v(" "),t("p",[e._v("In a shared server environment like "),t("a",{attrs:{href:"http://wcs.wayne.edu/",target:"_blank",rel:"noopener noreferrer"}},[e._v("we have"),t("OutboundLink")],1),e._v(" at "),t("a",{attrs:{href:"http://wayne.edu/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Wayne State University"),t("OutboundLink")],1),e._v(", we have found there is no easy way to keep track of the emails being sent through php’s mail() function. It would take an analysis of the mail server logs or a friendly sysadmin of another server to alert you if there is a bot taking advantage of a mail() script on your site.")]),e._v(" "),t("p",[e._v("To combat this we are developing an extension for "),t("a",{attrs:{href:"http://code.google.com/p/phpsimpl/wiki/Mail",target:"_blank",rel:"noopener noreferrer"}},[e._v("PHPSimpl’s Mail class"),t("OutboundLink")],1),e._v(" to instead of send out an email directly to inserts the message into a database and every five minutes a cron runs to send out all emails in the table and records them in a sent table.")]),e._v(" "),t("p",[t("strong",[e._v("This accomplishes:")])]),e._v(" "),t("ul",[t("li",[e._v("Making pages load faster, a DB insert is faster than a mail() function.")]),e._v(" "),t("li",[e._v("Frees up server resources to host pages instead of doing sendmail’s.")]),e._v(" "),t("li",[e._v("Determines really how many emails are being sent from the web server.")]),e._v(" "),t("li",[e._v("Keeping track of what sites are sending mail from what pages and by who.")]),e._v(" "),t("li",[e._v("The ability to flag emails before they are sent with keywords like “Viagra” and “Enlargement”.")])]),e._v(" "),t("p",[e._v("We are currently just testing the system and hope to include it right into PHPSimpl as a main class but it still needs some stress testing. So far the tests have all came back positive, we have discovered a few of our own forms that have been taken advantage of and we resolved some potential issues.")]),e._v(" "),t("p",[e._v("We also over estimated the amount of emails being sent out, we thought with 200 or so sites it would be ~500-700 emails a day, well it turns out once we fixed a few of the forms we are only sending out ~100 emails a day, not bad.")]),e._v(" "),t("p",[e._v("The graph at the top of the post is the last 5 days and how many emails have been sent out. Today the 6th there has only been 4 emails so far at the time i took the screenshot, 8am.")]),e._v(" "),t("p",[e._v("On the 4th we saw a spike in bot related emails, after some investigation and a few "),t("a",{attrs:{href:"http://recaptcha.net/",target:"_blank",rel:"noopener noreferrer"}},[e._v("recaptcha"),t("OutboundLink")],1),e._v(" additions we just about halved the number of emails the next day.")]),e._v(" "),t("p",[e._v("Next week we hope to have the system fully functional and have a better analysis and report of our findings.")])])}),[],!1,null,null,null);t.default=s.exports}}]);